<!DOCTYPE html [<!ENTITY times '&#215;'>]>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:bootstrap="http://xmlns.jcp.org/jsf/composite/components/bootstrap"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:libreccm="http://xmlns.jcp.org/jsf/composite/components/libreccm"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <ui:composition>

        <li class="form-check">
            <div class="d-flex">
                <c:if test="#{!node.subCategories.isEmpty()}">
                    <button aria-label="#{CmsDefaultStepsMessageBundle['categorization.tree.show_subcategories']}"
                            class="btn btn-light p-0 subcategories-toggler"
                            data-toggle="collapse"
                            data-target="#subcategories-#{node.categoryUuid}"
                            aria-expanded="#{node.subCategoryAssigned or isRoot ? 'true' : 'false'}"
                            aria-controls="subcategories-#{node.categoryUuid}"
                            type="button">
                        <span class="sr-only">#{CmsAdminMessages['categorization.tree.expand']}
                        </span>
                    </button>
                </c:if>
                <label class="form-check-label"
                       for="#{node.categoryUuid}">
                    <c:choose>
                        <c:when test="#{node.title != null and !node.title.isBlank()}">
                            #{node.title}
                        </c:when>
                        <c:otherwise>
                            #{node.categoryName}
                        </c:otherwise>
                    </c:choose>
                    
                </label>
                <input class="form-check-input"
                       id="#{node.categoryUuid}"
                       checked="#{node.assigned ? 'checked' : ''}"
                       name="assigned-categories"
                       type="checkbox"
                       value="#{node.categoryUuid}" />
            </div>
            <c:if test="#{!node.subCategories.isEmpty()}">
                <ul class="#{node.assigned or node.subCategoryAssigned or isRoot ? 'collapse.show' : 'collapse'} "
                    id="subcategories-#{node.categoryUuid}">
                    <c:forEach items="#{node.subCategories}"
                               var="subCat">
                        <ui:include src="categorization-tree-node.xhtml">
                            <ui:param name="node" 
                                      value="#{subCat}" />
                            <ui:param name="isRoot"
                                      value="false" />
                        </ui:include>
                    </c:forEach>
                </ul>
            </c:if>
        </li>

    </ui:composition>
</html>
