<!DOCTYPE html [<!ENTITY times '&#215;'>]>
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:bootstrap="http://xmlns.jcp.org/jsf/composite/components/bootstrap"
    xmlns:cc="http://xmlns.jcp.org/jsf/composite"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
>
    <cc:interface
        shortDescription="A editor component for HTML texts using the TipTap editor. To use this component you have also to include the cms-editor.js file into the page."
    >
        <!--        <cc:attribute
                    name="addMethod"
                    required="true"
                    shortDescription="URL of teh endpoint for adding localized values."
                    type="String"
                />
                <cc:attribute
                    name="addButtonLabel"
                    default="Add"
                    required="false"
                    shortDescription="Label for the add button"
                    type="String"
                />
                <cc:attribute
                    name="addDialogCancelLabel"
                    default="#{CmsAdminMessages['cancel_button.label']}"
                    required="false"
                    shortDescription="Label for the cancel and close buttons."
                    type="String"
                />
                <cc:attribute
                    name="addDialogLocaleSelectHelp"
                    default="The locale of the value of add"
                    required="false"
                    shortDescription="Help text for the locale select field"
                    type="String"
                />
                <cc:attribute
                    name="addDialogLocaleSelectLabel"
                    default="#{CmsAdminMessages['locale_select.label']}"
                    required="false"
                    shortDescription="Label for the locale select field"
                    type="String"
                />
                <cc:attribute
                    name="addDialogSubmitLabel"
                    default="#{CmsAdminMessages['locale_add.label']}"
                    required="false"
                    shortDescription="Label for the submit button"
                    type="String"
                />
                <cc:attribute
                    name="addDialogTitle"
                    default="#{CmsAdminMessages['locale_add.dialog.title']}"
                    required="false"
                    shortDescription="Title for the dialog."
                    type="String"
                />-->
        <cc:attribute
            name="backUrl"
            required="true"
            shortDescription="The back URL."
            type="String"
        />
        <cc:attribute
            name="canEdit"
            default="true"
            required="false"
            shortDescription="Can the current user edit the text?"
            type="boolean"
        />
        <!--        <cc:attribute
                    name="editButtonLabel"
                    default="#{CmsAdminMessages['edit_button.label']}"
                    required="false"
                    shortDescription="Label for the edit button"
                    type="String"
                />-->
        <cc:attribute
            name="editDialogCancelLabel"
            default="#{CmsAdminMessages['cancel_button.label']}"
            required="false"
            shortDescription="Label for the cancel and close button of the edit dialog"
            type="String"
        />
        <cc:attribute
            name="editDialogSubmitLabel"
            default="#{CmsAdminMessages['save_button.label']}"
            required="false"
            shortDescription="Label for the submit button of the edit dialog"
            type="String"
        />
        <cc:attribute
            name="editDialogValueHelp"
            default="Value to update"
            required="false"
            shortDescription="Help text for the value field"
            type="String"
        />
        <cc:attribute
            name="editDialogValueLabel"
            default="Value"
            required="false"
            shortDescription="Label for the value field"
            type="String"
        />
        <cc:attribute
            name="editDialogTitle"
            default="#{CmsAdminMessages['text.edit.dialog.title']}"
            required="false"
            shortDescription="Title for the edit dialog"
            type="String"
        />
        <cc:attribute
            name="editMethod"
            required="true"
            shortDescription="URL of the endpoint for editing/updating a value. The value of the locale to update is added after the provided URL, eg. /de for updating the german value."
            type="String"
        />
        <!--        <cc:attribute
                    name="hasUnusedLocales"
                    required="true"
                    shortDescription="Are there unused locales? This will usually be an expression pointing to some method. The result must resolve to boolean."
                    type="boolean"
                />-->
        <cc:attribute
            name="headingLevel"
            default="2"
            required="false"
            shortDescription="Level of the heading used for the component. Also determines the heading levels used for other parts of the component."
            type="int"
        />
        <cc:attribute
            name="editorId"
            required="true"
            shortDescription="ID for the editor. Also used as prefix to generate IDs for some subcomponents"
            type="String"
        />
        <!--        <cc:attribute
                    name="emptyText"
                    default="#{text.editor.no_localized_values}"
                    required="false"
                    shortDescription="Text shown if the localized has no values yet."
                    type="String"
                />-->
        <cc:attribute
            name="messageSaveFailed"
            default="Failed to save."
            required="false"
            type="String"
        />
        <cc:attribute
            name="messageSaveSuccessful"
            default="Saved sucessfully."
            required="false"
            type="String"
        />
        <cc:attribute
            name="messageVariantLoadFailed"
            default="Failed to load variant."
            required="false"
            type="String"
        />
        <cc:attribute
            name="mode"
            default="full"
            shortDescription="The editor mode. Use 'full' to enable all options including adding images etc. Use 'textonly' for a minimal version that only supports text editing, but does not allow insertation of images etc."
            required="false"
            type="String"
        />
        <cc:attribute
            name="objectIdentifier"
            required="true"
            shortDescription="Identifier of the object to which the localized string belongs"
            type="String"
        />
        <cc:attribute
            name="selectedLocale"
            required="true"
            shortDescription="The selected locale."
            type="String"
        />
        <!--        <cc:attribute
                    name="removeButtonLabel"
                    default="Remove"
                    required="false"
                    shortDescription="Label for the remove button"
                    type="String"
                />
                <cc:attribute
                    name="removeDialogCancelLabel"
                    default="Cancel"
                    required="false"
                    shortDescription="Label for the cancel and close buttons of the remove dialog"
                    type="String"
                />
                <cc:attribute
                    name="removeDialogSubmitLabel"
                    default="Remove localized value"
                    required="false"
                    shortDescription="Label for the submit button of the remove dialog (removes the localized value)"
                    type="String"
                />
                <cc:attribute
                    name="removeDialogText"
                    default="Are you sure to remove the following localized value?"
                    required="false"
                    shortDescription="Text for the remove dialog"
                    type="String"
                />
                <cc:attribute
                    name="removeDialogTitle"
                    default="Remove localized value"
                    required="false"
                    shortDescription="The title of the remove dialog"
                    type="String"
                />
                <cc:attribute
                    name="removeMethod"
                    required="true"
                    shortDescription="URL of the endpoint for remvoving a value. The locale of the value to remove is added to the end of the URL. Eg. /de for removing the value for the locale de."
                    type="String"
                />
                <cc:attribute
                    name="tableActionsHeading"
                    default="Actions"
                    required="false"
                    shortDescription="Heading for the action columns"
                    type="String"
                />
                <cc:attribute
                    name="tableLocaleHeading"
                    default="Locale"
                    required="false"
                    shortDescription="Heading for the locale column"
                    type="String"
                />
                <cc:attribute
                    name="tableWordCountHeading"
                    default="Words"
                    required="false"
                    shortDescription="Heading for the word count column"
                    type="String"
                />-->
        <cc:attribute
            name="title"
            required="true"
            shortDescription="Title/Heading of the editor widget"
            type="String"
        />
        <!--        <cc:attribute
                    name="unusedLocales"
                    required="true"
                    shortDescription="A collection of the unused locales of the edited localized string"
                    type="java.util.Collection"
                />
                <cc:attribute
                    name="variants"
                    required="true"
                    shortDescription="Info about the available variants. Must be a List of CmsEditorLocaleVariantRow objects."
                    type="java.util.List"
                />-->
        <cc:attribute
            name="variantUrl"
            required="true"
            shortDescription="URL of the endpoint for retrieving a variant. The locale of the variant to retrieve is appended as last token."
            type="String"
        />
        <!--        <cc:attribute name="viewButtonLabel" default="View" type="String" />
                <cc:attribute name="viewDialogTitle" default="View" type="String" />
                <cc:attribute
                    name="viewDialogEditButtonLabel"
                    default="Edit"
                    type="String"
                />
                <cc:attribute
                    name="viewDialogCloseButtonLabel"
                    default="Close"
                    type="String"
                />
                <cc:attribute
                    name="wordCountUrl"
                    required="true"
                    shortDescription="URL of the endpoint for retrieving the wordcount of a variant. The locale of the variant to retrieve is appended as last token."
                    type="String"
                />-->
    </cc:interface>
    <cc:implementation>
        <div
            class="cms-editor"
            data-locale="#{cc.attrs.selectedLocale}"
            data-save-url="#{cc.attrs.editMethod}/#{variant.locale}"
            data-variant-url="#{cc.attrs.variantUrl}/#{cc.attrs.selectedLocale}"
            id="#{cc.attrs.editorId}"
        >
            <c:choose>
                <c:when test="#{cc.attrs.headingLevel == 1}">
                    <h1>#{cc.attrs.title}</h1>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 2}">
                    <h2>#{cc.attrs.title}</h2>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 3}">
                    <h3>#{cc.attrs.title}</h3>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 4}">
                    <h4>#{cc.attrs.title}</h4>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 5}">
                    <h5>#{cc.attrs.title}</h5>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 6}">
                    <h6>#{cc.attrs.title}</h6>
                </c:when>
                <c:otherwise>
                    <div>#{cc.attrs.title}</div>
                </c:otherwise>
            </c:choose>
            <div class="cms-editor-messages">
                <template id="cms-editor-msg-canvas-element-not-found">
                    <div class="alert alert alert-danger" role="alert">
                        #{CmsAdminMessages['cms_editor.internal_error']}
                    </div>
                </template>
                <template id="cms-editor-msg-save-failed">
                    <div class="alert alert alert-danger" role="alert">
                        #{cc.attrs.messageSaveFailed}
                    </div>
                </template>
                <template id="cms-editor-msg-save-successful">
                    <div class="alert alert-success" role="alert">
                        #{cc.attrs.messageSaveSuccessful}
                    </div>
                </template>
                <template id="cms-editor-msg-variant-load-failed">
                    <div class="alert alert-warning" role="alert">
                        #{cc.attrs.messageVariantLoadFailed}
                    </div>
                </template>
            </div>
            <c:choose>
                <c:when test="#{cc.attrs.headingLevel == 1}">
                    <h2 id="#{cc.attrs.editorId}-edit-dialog-title">
                        #{cc.attrs.editDialogTitle} #{cc.attrs.selectedLocale}
                    </h2>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 2}">
                    <h3 id="#{cc.attrs.editorId}-edit-dialog-title">
                        #{cc.attrs.editDialogTitle} #{cc.attrs.selectedLocale}
                    </h3>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 3}">
                    <h4 id="#{cc.attrs.editorId}-edit-dialog-title">
                        #{cc.attrs.editDialogTitle} #{cc.attrs.selectedLocale}
                    </h4>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 4}">
                    <h5 id="#{cc.attrs.editorId}-edit-dialog-title">
                        #{cc.attrs.editDialogTitle} #{cc.attrs.selectedLocale}
                    </h5>
                </c:when>
                <c:when test="#{cc.attrs.headingLevel == 5}">
                    <h6 id="#{cc.attrs.editorId}-edit-dialog-title">
                        #{cc.attrs.editDialogTitle} #{cc.attrs.selectedLocale}
                    </h6>
                </c:when>
                <c:otherwise>
                    <div id="#{cc.attrs.editorId}-edit-dialog-title">
                        #{cc.attrs.editDialogTitle} #{cc.attrs.selectedLocale}
                    </div>
                </c:otherwise>
            </c:choose>
            <div
                class="cms-tiptap-editor"
                data-locale="#{cc.attrs.selectedLocale}"
                data-variant-url="#{cc.attrs.variantUrl}/#{cc.attrs.selectedLocale}"
            >
                <div class="cms-tiptap-editor-buttons d-flex mb-1">
                    <div class="px-2 cms-tiptap-editor-textformatting">
                        <button
                            class="btn btn-outline-dark tiptap-emph"
                            title="#{CmsAdminMessages['cms_editor.buttons.emph']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="type-italic" />
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-strong-emph"
                            title="#{CmsAdminMessages['cms_editor.buttons.strong_emph']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="type-bold" />
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-code"
                            title="#{CmsAdminMessages['cms_editor.buttons.code']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="code" />
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-strikethrough"
                            title="#{CmsAdminMessages['cms_editor.buttons.strikethrough']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="type-strikethrough" />
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-subscript"
                            title="#{CmsAdminMessages['cms_editor.buttons.subscript']}"
                            type="button"
                        >
                            <span aria-hidden="true">x<sub>n</sub></span>
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-superscript"
                            title="#{CmsAdminMessages['cms_editor.buttons.superscript']}"
                            type="button"
                        >
                            <span aria-hidden="true">x<sup>n</sup></span>
                        </button>
                    </div>
                    <div class="px-2 cms-tiptap-editor-headings">
                        <ui:repeat begin="1" end="6" var="level">
                            <button
                                class="btn btn-outline-dark tiptap-h#{level}"
                                title="#{CmsAdminMessages['cms_editor.buttons.h'.concat(level)]}"
                                type="button"
                            >
                                <span aria-hidden="true">H#{level}</span>
                            </button>
                        </ui:repeat>
                    </div>
                    <div class="px-2 cms-tiptap-editor-paragraphs">
                        <button
                            class="btn btn-outline-dark tiptap-paragraph"
                            title="#{CmsAdminMessages['cms_editor.buttons.paragraph']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="type" />
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-blockquote"
                            title="#{CmsAdminMessages['cms_editor.buttons.blockquote']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="blockquote-left" />
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-codeblock"
                            title="#{CmsAdminMessages['cms_editor.buttons.codeblock']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="code-square" />
                        </button>
                    </div>
                    <div class="px-2 cms-tiptap-editor-lists">
                        <button
                            class="btn btn-outline-dark tiptap-ul"
                            title="#{CmsAdminMessages['cms_editor.buttons.ul']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="list-ul" />
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-ol"
                            title="#{CmsAdminMessages['cms_editor.buttons.ol']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="list-ol" />
                        </button>
                    </div>
                    <div class="px-2 cms-tiptap-editor-table">
                        <button
                            class="btn btn-outline-dark tiptap-insert-table"
                            data-target="#insert-table-dialog"
                            data-toggle="modal"
                            title="#{CmsAdminMessage['cms_editor.buttons.insert_table']}"
                            type="button"
                        >
                            <bootstrap:svgIcon icon="table" />
                        </button>
                        <div
                            aria-hidden="true"
                            aria-labelledby="insert-table-dialog-title"
                            class="modal fade cms-editor-insert-table-dialog"
                            id="insert-table-dialog"
                            tabindex="-1"
                        >
                            <div class="modal-dialog">
                                <form class="modal-content">
                                    <div class="modal-header">
                                        <h4
                                            class="modal-title"
                                            id="insert-table-dialog-title"
                                        >
                                            #{CmsAdminMessages['cms_editor.dialogs.insert_table.title']}
                                        </h4>
                                        <button
                                            aria-label="#{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.close']}"
                                            class="close"
                                            data-dismiss="modal"
                                            type="button"
                                        >
                                            <bootstrap:svgIcon icon="x" />
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <bootstrap:formGroupNumber
                                            help="#{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.rows.help']}"
                                            inputId="rows"
                                            label="#{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.rows.label']}"
                                            name="rows"
                                        />
                                        <bootstrap:formGroupNumber
                                            help="#{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.cols.help']}"
                                            inputId="cols"
                                            label="#{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.cols.label']}"
                                            name="cols"
                                        />
                                        <bootstrap:formCheck
                                            checked="true"
                                            inputId="headerRow"
                                            label="#{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.header_row.label']}"
                                            name="headerRow"
                                            value="true"
                                        />
                                    </div>
                                    <div class="modal-footer">
                                        <button
                                            class="
                                                btn btn-warning
                                                cms-editor-cancel-button
                                            "
                                            data-dismiss="modal"
                                            type="button"
                                        >
                                            #{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.close']}
                                        </button>
                                        <button
                                            class="btn btn-success"
                                            data-dismiss="modal"
                                            data-backdrop="false"
                                            type="submit"
                                        >
                                            #{CmsDefaultStepsMessageBundle['cms_editor.dialogs.insert_table.submit']}
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <button
                            class="btn btn-outline-dark tiptap-remove-table"
                            title="#{CmsAdminMessage['cms_editor.buttons.remove_table']}"
                            type="button"
                        >
                            Remove table
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-insert-table-row-before"
                            title="#{CmsAdminMessage['cms_editor.buttons.insert_table_row_before']}"
                            type="button"
                        >
                            Insert row before
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-insert-table-row-after"
                            title="#{CmsAdminMessage['cms_editor.buttons.insert_table_row_after']}"
                            type="button"
                        >
                            Insert row after
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-table-remove-row"
                            title="#{CmsAdminMessages['cms_editor.buttons.remove_table_row']}"
                            type="button">
                            Remove row
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-insert-table-column-before"
                            title="#{CmsAdminMessage['cms_editor.buttons.insert_table_column_before']}"
                            type="button"
                        >
                            Insert column before
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-insert-table-column-after"
                            title="#{CmsAdminMessage['cms_editor.buttons.insert_table_column_after']}"
                            type="button"
                        >
                            Insert column after
                        </button>
                        <button
                            class="btn btn-outline-dark tiptap-remove-table-column"
                            title="#{CmsAdminMessage['cms_editor.buttons.remove_table_column']}"
                            type="button"
                        >
                            Remove column
                        </button>
                        <button 
                            class="btn btn-outline-dark tiptap-toggle-table-header-row"
                            title="#{CmsAdminMessage['cms_editor.buttons.toggle_header_rowy']}"
                            type="button">
                            Toggle Header row
                        </button>
                        <button 
                            class="btn btn-outline-dark tiptap-toggle-table-header-column"
                            title="#{CmsAdminMessage['cms_editor.buttons.toggle_header_column']}"
                            type="button">
                            Toggle Header column
                        </button>
                        <button 
                            class="btn btn-outline-dark tiptap-merge-table-cells"
                            title="#{CmsAdminMessage['cms_editor.buttons.merge-table-cells']}"
                            type="button">
                            Merge cells
                        </button>
                        <button 
                            class="btn btn-outline-dark tiptap-split-table-cell"
                            title="#{CmsAdminMessage['cms_editor.buttons.split-table-cell']}"
                            type="button">
                            Split cell
                        </button>
                    </div>
                </div>
                <div
                    class="cms-tiptap-editor-canvas border"
                    data-locale="#{cc.attrs.selectedLocale}"
                    data-variant-url="#{cc.attrs.variantUrl}"
                ></div>
                <div class="mt-3">
                    <a
                        class="btn btn-warning cms-editor-cancel-button"
                        href="#{backUrl}"
                    >
                        #{cc.attrs.editDialogCancelLabel}
                    </a>
                    <button
                        class="btn btn-success cms-editor-save-button"
                        disabled="#{cc.attrs.canEdit ? '' : 'disabled'}"
                        type="button"
                    >
                        #{cc.attrs.editDialogSubmitLabel}
                    </button>
                </div>
            </div>
        </div>
    </cc:implementation>
</html>
